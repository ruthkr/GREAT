<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="greatR">
<title>Visualising results â€¢ greatR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Lato-0.4.0/font.css" rel="stylesheet">
<link href="../deps/_Fira%20Code-0.4.0/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualising results">
<meta property="og:description" content="greatR">
<meta property="og:image" content="https://ruthkr.github.io/greatR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">greatR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/prepare_data.html">Preparing data</a>
    <a class="dropdown-item" href="../articles/register-data.html">Registering data</a>
    <a class="dropdown-item" href="../articles/visualise-results.html">Visualising results</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ruthkr/greatR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="visualise-results_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visualising results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ruthkr/greatR/blob/HEAD/vignettes/visualise-results.Rmd" class="external-link"><code>vignettes/visualise-results.Rmd</code></a></small>
      <div class="d-none name"><code>visualise-results.Rmd</code></div>
    </div>

    
    
<p>After running registration function <code><a href="../reference/scale_and_register_data.html">scale_and_register_data()</a></code> as shown in the <a href="https://ruthkr.github.io/greatR/articles/register-data.html">registering data</a> article, users can summarise and visualise the results as illustrated in the figure below.</p>
<p><br></p>
<p><img src="figures/visualisation_process.png" width="80%"></p>
<p><br></p>
<div class="section level2">
<h2 id="get-summary-from-registration-results">Get summary from registration results<a class="anchor" aria-label="anchor" href="#get-summary-from-registration-results"></a>
</h2>
<p>The total number of registered and non-registered genes can be obtained by running function <code><a href="../reference/summary_model_comparison.html">summary_model_comparison()</a></code> with <code>registration_results$model_comparison_df</code> as an input.</p>
<p>Function <code><a href="../reference/summary_model_comparison.html">summary_model_comparison()</a></code> returns a list which contains three different objects:</p>
<ul>
<li>
<code>df_summary</code> contains result summaries of the registration results,</li>
<li>
<code>registered_genes</code> is list of gene accessions which were successfully registered, and</li>
<li>
<code>non_registered_genes</code> is a list of non-registered gene accessions.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get all of summary</span>
<span class="va">all_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summary_model_comparison.html">summary_model_comparison</a></span><span class="op">(</span><span class="va">registration_results</span><span class="op">$</span><span class="va">model_comparison_df</span><span class="op">)</span>

<span class="va">all_summary</span><span class="op">$</span><span class="va">df_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Result</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Total genes</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">Registered genes</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">Non-registered genes</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Stretch</td>
<td align="left">1.5, 2, 2.5, 3</td>
</tr>
<tr class="odd">
<td align="left">Shift</td>
<td align="left">[-3.5, 1.5]</td>
</tr>
</tbody>
</table>
<p>The list of gene accessions which were registered can be viewed by calling:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_summary</span><span class="op">$</span><span class="va">registered_genes</span>
<span class="co">#&gt;  [1] "BRAA04G005470.3C" "BRAA09G045310.3C" "BRAA03G051930.3C" "BRAA06G025360.3C"</span>
<span class="co">#&gt;  [5] "BRAA02G043220.3C" "BRAA03G023790.3C" "BRAA05G005370.3C" "BRAA02G018970.3C"</span>
<span class="co">#&gt;  [9] "BRAA07G030470.3C" "BRAA07G034100.3C"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-registration-results">Plot registration results<a class="anchor" aria-label="anchor" href="#plot-registration-results"></a>
</h2>
<p>Function <code><a href="../reference/plot_registration_results.html">plot_registration_results()</a></code> allows users to plot registration results of the genes of interest.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot registration result</span>
<span class="fu"><a href="../reference/plot_registration_results.html">plot_registration_results</a></span><span class="op">(</span>
  <span class="va">registration_results</span><span class="op">$</span><span class="va">imputed_mean_df</span>,
  ncol <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span></code></pre></div>
<p><img src="visualise-results_files/figure-html/plot-results-1.png" width="960"> Users also have an option to include information or label on the plot whether particular genes are registered or not, as well as the registration parameters by include model comparison data frame as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot registration result</span>
<span class="fu"><a href="../reference/plot_registration_results.html">plot_registration_results</a></span><span class="op">(</span>
  <span class="va">registration_results</span><span class="op">$</span><span class="va">imputed_mean_df</span>,
  <span class="va">registration_results</span><span class="op">$</span><span class="va">model_comparison_df</span>,
  ncol <span class="op">=</span> <span class="fl">3</span>,
  sync_timepoints <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p><img src="visualise-results_files/figure-html/plot-results-with-label-1.png" width="960"></p>
<p>Notice that to only include same time points between samples, users can set <code>sync_timepoints = TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="analyse-similarity-of-expression-profiles-overtime-before-and-after-registering">Analyse similarity of expression profiles overtime before and after registering<a class="anchor" aria-label="anchor" href="#analyse-similarity-of-expression-profiles-overtime-before-and-after-registering"></a>
</h2>
<div class="section level3">
<h3 id="calculate-sample-distance">Calculate sample distance<a class="anchor" aria-label="anchor" href="#calculate-sample-distance"></a>
</h3>
<p>After registering the sample data, users can compare the overall similarity before and after registering using the function <code><a href="../reference/calculate_between_sample_distance.html">calculate_between_sample_distance()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_between_sample_distance.html">calculate_between_sample_distance</a></span><span class="op">(</span>
  <span class="va">registration_results</span><span class="op">$</span><span class="va">mean_df</span>,
  <span class="va">registration_results</span><span class="op">$</span><span class="va">mean_df_sc</span>,
  <span class="va">registration_results</span><span class="op">$</span><span class="va">imputed_mean_df</span>,
  accession_data_ref <span class="op">=</span> <span class="st">"Ro18"</span>
<span class="op">)</span></code></pre></div>
<p>Function <code><a href="../reference/calculate_between_sample_distance.html">calculate_between_sample_distance()</a></code> returns a list of seven data frames:</p>
<ul>
<li>
<code>distance_mean_df</code> is distance of mean expression values.</li>
<li>
<code>distance_scaled_mean_df</code> is distance of scaled mean expression (all genes).</li>
<li>
<code>distance_scaled_mean_df_only_nonreg</code> is distance of scaled mean expression (only not-registered genes).</li>
<li>
<code>distance_scaled_mean_df_only_reg</code> is distance of scaled mean expression (only registered genes).</li>
<li>
<code>distance_registered_df</code> is distance of registered &amp; scaled mean expression (all genes).</li>
<li>
<code>distance_registered_df_only_reg</code> is distance of registered &amp; scaled mean expression (only registered genes).</li>
</ul>
</div>
<div class="section level3">
<h3 id="plot-heatmap-of-sample-distances">Plot heatmap of sample distances<a class="anchor" aria-label="anchor" href="#plot-heatmap-of-sample-distances"></a>
</h3>
<p>Each of these data frames above can be visualised using function <code><a href="../reference/plot_heatmap.html">plot_heatmap()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot heatmap of mean expression profiles distance before scaling</span>
<span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span><span class="va">sample_distance</span><span class="op">$</span><span class="va">distance_mean_df</span><span class="op">)</span></code></pre></div>
<p><img src="visualise-results_files/figure-html/plot-dist-mean-df-1.png" width="480"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot heatmap of mean expression profiles distance after scaling</span>
<span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span><span class="va">sample_distance</span><span class="op">$</span><span class="va">distance_scaled_mean_df</span><span class="op">)</span></code></pre></div>
<p><img src="visualise-results_files/figure-html/plot-dist-scaled-mean-df-1.png" width="480"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot heatmap of mean expression profiles distance after registration process</span>
<span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>
  <span class="va">sample_distance</span><span class="op">$</span><span class="va">distance_registered_df_only_reg</span>, 
  same_max_timepoint <span class="op">=</span> <span class="cn">TRUE</span>, 
  same_min_timepoint <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p><img src="visualise-results_files/figure-html/plot-dist-registered-1.png" width="480"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://ruthkr.com" class="external-link">Ruth Kristianingsih</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
