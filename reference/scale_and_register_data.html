<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Register or synchronize different expression profiles — scale_and_register_data • GREAT</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Register or synchronize different expression profiles — scale_and_register_data"><meta property="og:description" content="scale_and_register_data() is a function to register expression profiles a user wish to compare. This includes an option to scale data before registration, find and calculate score of optimal shifts and stretches, as well as apply the best shifts and stretches."><meta property="og:image" content="https://ruthkr.github.io/GREAT/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GREAT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/prepare_data.html">Preparing data</a>
    </li>
    <li>
      <a href="../articles/register-data.html">Registering data</a>
    </li>
    <li>
      <a href="../articles/visualise-results.html">Visualising results</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Register or synchronize different expression profiles</h1>
    
    <div class="hidden name"><code>scale_and_register_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>scale_and_register_data()</code> is a function to register expression profiles a user wish to compare. This includes an option to scale data before registration, find and calculate score of optimal shifts and stretches, as well as apply the best shifts and stretches.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">scale_and_register_data</span><span class="op">(</span>
  <span class="va">input_df</span>,
  <span class="va">stretches</span>,
  <span class="va">shift_extreme</span>,
  <span class="va">num_shifts</span>,
  <span class="va">min_num_overlapping_points</span>,
  <span class="va">initial_rescale</span>,
  <span class="va">do_rescale</span>,
  <span class="va">accession_data_to_transform</span>,
  <span class="va">accession_data_ref</span>,
  start_timepoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="st">"transform"</span>, <span class="st">"zero"</span><span class="op">)</span>,
  expression_value_threshold <span class="op">=</span> <span class="fl">5</span>,
  is_data_normalised <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input_df</dt>
<dd><p>Input data frame contains all replicates of gene expression in each genotype at each time point.</p></dd>
<dt>stretches</dt>
<dd><p>Candidate registration stretch factors to apply to data to transform.</p></dd>
<dt>shift_extreme</dt>
<dd><p>The absolute maximum value which can be applied as a shift to gene expression time course (days).</p></dd>
<dt>num_shifts</dt>
<dd><p>Number of shifts between minimum and maximum values of shift.</p></dd>
<dt>min_num_overlapping_points</dt>
<dd><p>Number of minimum overlapping time points.  Shifts will be only considered if it leaves at least these many overlapping points after applying the registration function.</p></dd>
<dt>initial_rescale</dt>
<dd><p>Scaling gene expression prior to registration if <code>TRUE</code>.</p></dd>
<dt>do_rescale</dt>
<dd><p>Scaling gene expression using only overlapping time points points during registration.</p></dd>
<dt>accession_data_to_transform</dt>
<dd><p>Accession name of data which will be transformed.</p></dd>
<dt>accession_data_ref</dt>
<dd><p>Accession name of reference data.</p></dd>
<dt>start_timepoint</dt>
<dd><p>Time points to be added in both reference data and data to transform after shifting and stretching. Can be either <code>"reference"</code> (the default), <code>"transform"</code>, or <code>"zero"</code>.</p></dd>
<dt>expression_value_threshold</dt>
<dd><p>Expression value threshold. Remove expressions if maximum is less than the threshold. If <code>NULL</code> keep all data.</p></dd>
<dt>is_data_normalised</dt>
<dd><p>TRUE if dataset has been normalised prior to registration process.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>This function returns a list of data frames, containing:</p>
<dl><dt>mean_df</dt>
<dd><p>a data frame containing mean expression value of each gene and accession for every time point.</p></dd>
<dt>mean_df_sc</dt>
<dd><p>identical to <code>mean_df</code>, with additional column <code>sc.expression_value</code> which the scaled mean expression values.</p></dd>
<dt>to_shift_df</dt>
<dd><p>a processed input data frame which is ready to be registered.</p></dd>
<dt>shifted_mean_df</dt>
<dd><p>the registration result - after stretching and shifting.</p></dd>
<dt>imputed_mean_df</dt>
<dd><p>the imputed (transformed to be the same in a set of common time points) registration result.</p></dd>
<dt>all_shifts_df</dt>
<dd><p>a table containing candidates of registration parameters and a score after applying each parameter (stretch and shift factor).</p></dd>
<dt>model_comparison_df</dt>
<dd><p>a table comparing the optimal registration function for each gene (based on <code>all_shifts_df</code> scores) to model with no registration applied.</p></dd>
</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Load a data frame from the sample data</span></span>
<span class="r-in"><span class="va">all_data_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/brapa_arabidopsis_all_replicates.csv"</span>, package <span class="op">=</span> <span class="st">"GREAT"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Running the registration</span></span>
<span class="r-in"><span class="va">registration_results</span> <span class="op">&lt;-</span> <span class="fu">scale_and_register_data</span><span class="op">(</span></span>
<span class="r-in">    input_df <span class="op">=</span> <span class="va">all_data_df</span>,</span>
<span class="r-in">    stretches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">    shift_extreme <span class="op">=</span> <span class="fl">4</span>,</span>
<span class="r-in">    num_shifts <span class="op">=</span> <span class="fl">27</span>,</span>
<span class="r-in">    min_num_overlapping_points <span class="op">=</span> <span class="fl">4</span>,</span>
<span class="r-in">    initial_rescale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">    do_rescale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">    accession_data_to_transform <span class="op">=</span> <span class="st">"Col0"</span>,</span>
<span class="r-in">    accession_data_ref <span class="op">=</span> <span class="st">"Ro18"</span>,</span>
<span class="r-in">    start_timepoint <span class="op">=</span> <span class="st">"reference"</span></span>
<span class="r-in"> <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://ruthkr.com" class="external-link">Ruth Kristianingsih</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

